import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as r,b as a,d as s,e as p,f as n,a as l,g as c,r as o,o as d}from"./app-DJGYRO-r.js";const m={};function h(u,e){const i=o("RouteLink");return d(),r("div",null,[e[3]||(e[3]=a("p",null,"本文详细记录了在云服务器上部署Perforce的完整流程。之前在知乎上介绍过使用NAS部署P4,以及Perforce的工作原理和作用。这次我们将探讨如何在没有NAS的情况下,快速为团队创建一个Perforce服务。",-1)),e[4]||(e[4]=a("p",null,[a("i",{class:"fa-solid fa-cable-car"}),s(" 相关文章："),a("a",{href:"https://www.zhihu.com/tardis/zm/art/606970716?source_id=1005",target:"_blank",rel:"noopener noreferrer"},"从零开始在NAS上配置Perforce并启用虚幻引擎源码管理")],-1)),p(" more "),e[5]||(e[5]=n(`<h2 id="购买服务器" tabindex="-1"><a class="header-anchor" href="#购买服务器"><span>购买服务器</span></a></h2><p>本文以腾讯云为例进行演示。</p><p><a href="https://cloud.tencent.com/act/free?from=19067" target="_blank" rel="noopener noreferrer">腾讯云优惠活动链接</a></p><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/9ecfdc66dcdee766d6297a314d98daa0.image.webp" style="width:90% !important;"></div><p>通过上述新用户福利,我们可以获得一个月免费的轻量服务器。在选择系统时,建议直接使用Docker镜像,这样可以快速使用docker,无需额外安装。</p><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/180c0ea68a43c7518a4c01850e515262.clipboard-2023-10-18.webp" style="width:90% !important;"></div><p>购买完服务器后,你将通过邮件收到服务器的账号和登录密码。</p><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/6ed0ea4a45366f5589597c6054d66261.clipboard-2023-10-19.webp" style="width:90% !important;"></div><p> </p><h2 id="开始部署" tabindex="-1"><a class="header-anchor" href="#开始部署"><span>开始部署</span></a></h2><p>登录到你的服务器:</p><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/93da21e2caaa9adca4c819917440bfbe.clipboard-2023-10-19.webp" style="width:90% !important;"></div><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/0ea5fb1aa5dece4f8d29f81b25e6c207.clipboard-2023-10-19.webp" style="width:90% !important;"></div><p>登录后,输入<code>sudo -i</code>获取root权限:</p><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/c03d4a9469ad6576c7308690160a6528.clipboard-2023-10-19.webp" style="width:80% !important;"></div><h2 id="部署perforce" tabindex="-1"><a class="header-anchor" href="#部署perforce"><span>部署Perforce</span></a></h2><p> </p><h3 id="一键部署" tabindex="-1"><a class="header-anchor" href="#一键部署"><span>一键部署</span></a></h3><p>复制并执行以下命令来部署Perforce镜像:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-d</span>  <span class="token parameter variable">-p</span> <span class="token number">1666</span>:1666 <span class="token parameter variable">-v</span> /volume1/docker/perforce/data:/data <span class="token parameter variable">-e</span> P4USER:p4admin <span class="token parameter variable">--name</span> perforce ambakshi/perforce-server</span>
<span class="line"></span>
<span class="line"><span class="token function">docker</span> logs <span class="token parameter variable">-f</span> perforce</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/dffc4ed5eaf39b59574564049f32a357.image.webp" style="width:90% !important;"></div><p>部署完成后,执行<code>docker logs -f perforce</code>获取Perforce的日志,从中可以找到P4的管理员账号和密码。</p><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/31e4ecc7f86de925883ddc6ab1e29397.image.webp" style="width:90% !important;"></div><p>默认的管理员账号和密码如下:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">P4PORT=1666</span>
<span class="line">P4USER=p4admin</span>
<span class="line">P4PASSWD=pass12349ers!</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p> </p><h3 id="支持unicode的镜像" tabindex="-1"><a class="header-anchor" href="#支持unicode的镜像"><span>支持Unicode的镜像</span></a></h3><p>如果需要Unicode支持,可以使用以下命令安装支持Unicode的镜像:</p><h4 id="docker-pull" tabindex="-1"><a class="header-anchor" href="#docker-pull"><span>docker pull</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> <span class="token parameter variable">-sSLf</span> https://xy.ggbond.org/xy/docker_pull.sh<span class="token variable">)</span></span>&quot;</span> <span class="token parameter variable">-s</span> hawkmothstudio/helix-p4d:latest /volume1/docker/temp</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="docker-run" tabindex="-1"><a class="header-anchor" href="#docker-run"><span>docker run</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--restart</span><span class="token operator">=</span>always <span class="token parameter variable">-p</span> <span class="token number">1666</span>:1666 <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-v</span> /volume1/docker/perforce/data:/data <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-e</span> <span class="token assign-left variable">P4D_CASE_SENSITIVE</span><span class="token operator">=</span>true <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">-e</span> <span class="token assign-left variable">P4D_USE_UNICODE</span><span class="token operator">=</span>true <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--name</span> perforce hawkmothstudio/helix-p4d:latest</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container important"><p class="hint-container-title">重要</p><p>有些系统可能需要设置文件夹的访问权限 比如 <code>Debian Linux</code> 那么我们可以把<code>data</code>文件夹设置为<code>所有人可访问</code>,就看可以避免每次重启<code>data/root</code>文件夹权限丢失的问题。</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo chmod -R 777 /volume1/docker/perforce/data</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><p> </p><h3 id="开放防火墙端口" tabindex="-1"><a class="header-anchor" href="#开放防火墙端口"><span>开放防火墙端口</span></a></h3><p>在腾讯云服务器的防火墙设置中,需要开放<code>1666</code>和<code>8080</code>端口,以便团队成员能够访问。</p><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/c2766ff110944bc6ed07b58af1eb5ae8.image.webp" style="width:90% !important;"></div><p> </p><h2 id="安装p4v客户端" tabindex="-1"><a class="header-anchor" href="#安装p4v客户端"><span>安装P4V客户端</span></a></h2><p>团队成员需要安装P4V客户端来连接Perforce服务器。</p><p><a href="https://www.perforce.com/downloads/helix-visual-client-p4v" target="_blank" rel="noopener noreferrer">P4V下载地址</a></p><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/4dfa81522be498514ca684e195c15d71.image.webp" style="width:90% !important;"></div><h3 id="p4v安装过程" tabindex="-1"><a class="header-anchor" href="#p4v安装过程"><span>P4V安装过程</span></a></h3><p>安装过程中,如果无法执行下一步,可以填写<code>[ip]:1666</code>来继续。</p><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/eed1a21de36a198d1ad977c02e5101b8.image.webp" style="width:75% !important;"></div><p>按照提示完成安装,然后输入账号密码登录。</p><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/a45b9bf8c83d41ce3d8b677190873260.image.webp" style="width:75% !important;"></div><p>登录成功后,你将看到如下界面:</p><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/08741e445fe305f48a8c260b9ef23e2c.image.webp" style="width:90% !important;"></div><p>至此,Perforce部署完成! <i class="fa-regular fa-face-smile-wink"></i></p><p> </p><h2 id="使用说明" tabindex="-1"><a class="header-anchor" href="#使用说明"><span>使用说明</span></a></h2><p>关于Perforce的详细使用方法,可以参考以下资源:</p><ul><li><a href="https://www.perforce.com/manuals/p4v/Content/P4V/chapter.using.html" target="_blank" rel="noopener noreferrer">使用P4V</a></li><li><a href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/using-perforce-as-source-control?application_version=4.27" target="_blank" rel="noopener noreferrer">UE-向Perforce添加文件</a></li><li><a href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/source-control-in-unreal-engine?application_version=5.0" target="_blank" rel="noopener noreferrer">UE-源码管理</a></li></ul><h2 id="p4-typemap-和-p4ignore" tabindex="-1"><a class="header-anchor" href="#p4-typemap-和-p4ignore"><span>P4 Typemap 和 P4ignore</span></a></h2><h3 id="p4-typemap" tabindex="-1"><a class="header-anchor" href="#p4-typemap"><span>P4 Typemap</span></a></h3><p>在向新的Depot添加文件前,应先设置P4 Typemap。这可以让Perforce了解如何处理虚幻文件类型。</p><ol><li>在P4V中,右击仓库并选择使用CMD命令行。</li></ol><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/202408241303526.png" style="width:40% !important;"></div><ol start="2"><li>使用以下命令打开typemap设置:</li></ol><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">p4 <span class="token parameter variable">-P</span> YourPassword typemap</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="3"><li>在打开的文本窗口中,添加以下typemap示例:</li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line"># Perforce File Type Mapping Specifications.</span>
<span class="line">#</span>
<span class="line"># TypeMap: a list of filetype mappings; one per line.</span>
<span class="line"># Each line has two elements:</span>
<span class="line">#</span>
<span class="line"># Filetype: The filetype to use on &#39;p4 add&#39;.</span>
<span class="line">#</span>
<span class="line"># Path: File pattern which will use this filetype.</span>
<span class="line">#</span>
<span class="line"># See &#39;p4 help typemap&#39; for more information.</span>
<span class="line"></span>
<span class="line">TypeMap:</span>
<span class="line">	binary+w //depot/....exe</span>
<span class="line">	binary+w //depot/....dll</span>
<span class="line">	binary+w //depot/....lib</span>
<span class="line">	binary+w //depot/....app</span>
<span class="line">	binary+w //depot/....dylib</span>
<span class="line">	binary+w //depot/....stub</span>
<span class="line">	binary+w //depot/....ipa</span>
<span class="line">	binary //depot/....bmp</span>
<span class="line">	text //depot/....ini</span>
<span class="line">	text //depot/....config</span>
<span class="line">	text //depot/....cpp</span>
<span class="line">	text //depot/....h</span>
<span class="line">	text //depot/....c</span>
<span class="line">	text //depot/....cs</span>
<span class="line">	text //depot/....m</span>
<span class="line">	text //depot/....mm</span>
<span class="line">	text //depot/....py</span>
<span class="line">	binary+l //depot/....uasset</span>
<span class="line">	binary+l //depot/....umap</span>
<span class="line">	binary+l //depot/....upk</span>
<span class="line">	binary+l //depot/....udk</span>
<span class="line">	binary+l //depot/....ubulk</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>完成编辑后,按Ctrl+S保存并退出。命令行应提示&quot;Typemap saved&quot;。</p><h3 id="p4ignore" tabindex="-1"><a class="header-anchor" href="#p4ignore"><span>P4ignore</span></a></h3><p>为了避免上传不必要的文件,建议设置P4ignore。你可以:</p>`,66)),a("ul",null,[a("li",null,[e[1]||(e[1]=s("参考")),l(i,{to:"/posts/Perforce/P4ignore.html"},{default:c(()=>e[0]||(e[0]=[s("P4ignore设置指南")])),_:1})]),e[2]||(e[2]=a("li",null,[s("或按照"),a("a",{href:"https://www.perforce.com/manuals/p4v/Content/P4V/ignore-files.html",target:"_blank",rel:"noopener noreferrer"},"官方文档"),s("设置忽略文件。")],-1))]),e[6]||(e[6]=n('<p> </p><h2 id="ue5源码连接" tabindex="-1"><a class="header-anchor" href="#ue5源码连接"><span>UE5源码连接</span></a></h2><p>要将UE5连接到Perforce:</p><ol><li>启动引擎后,点击右下角的版本控制 -&gt; 连接到版本控制。</li><li>选择提供方为Perforce。</li><li>选择可用的工作区。</li><li>接受设置。</li></ol><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/UESourcelink.png" style="width:95% !important;"></div><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/UESourcelink2.png" style="width:60% !important;"></div><div class="hint-container info"><p class="hint-container-title">注意</p><p>连接源码前,需要先登录P4V。</p></div><div class="image-preview"><img src="https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/UESourcelink3.png" style="width:60% !important;"></div><p>连接后,UE5中的版本控制使用方法与P4V类似,此处不再赘述。</p>',9))])}const b=t(m,[["render",h],["__file","PerforceSet.html.vue"]]),f=JSON.parse('{"path":"/posts/Perforce/PerforceSet.html","title":"UE5+Perforce+腾讯云版本控制搭建流程与工作流程","lang":"zh-CN","frontmatter":{"title":"UE5+Perforce+腾讯云版本控制搭建流程与工作流程","icon":"iconfont alicon-perforce","category":["Perforce"],"tags":["Perforce","Cloud server","Teams","UE5"],"date":"2023-12-20T00:00:00.000Z","star":5,"cover":"https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/p4nas.png","description":"本文详细记录了在云服务器上部署Perforce的完整流程。之前在知乎上介绍过使用NAS部署P4,以及Perforce的工作原理和作用。这次我们将探讨如何在没有NAS的情况下,快速为团队创建一个Perforce服务。 相关文章：从零开始在NAS上配置Perforce并启用虚幻引擎源码管理","head":[["meta",{"property":"og:url","content":"https:///about.md/blog/posts/Perforce/PerforceSet.html"}],["meta",{"property":"og:site_name","content":"Megestus"}],["meta",{"property":"og:title","content":"UE5+Perforce+腾讯云版本控制搭建流程与工作流程"}],["meta",{"property":"og:description","content":"本文详细记录了在云服务器上部署Perforce的完整流程。之前在知乎上介绍过使用NAS部署P4,以及Perforce的工作原理和作用。这次我们将探讨如何在没有NAS的情况下,快速为团队创建一个Perforce服务。 相关文章：从零开始在NAS上配置Perforce并启用虚幻引擎源码管理"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/p4nas.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-03T04:57:26.000Z"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/p4nas.png"}],["meta",{"name":"twitter:image:alt","content":"UE5+Perforce+腾讯云版本控制搭建流程与工作流程"}],["meta",{"property":"article:tag","content":"Perforce"}],["meta",{"property":"article:tag","content":"Cloud server"}],["meta",{"property":"article:tag","content":"Teams"}],["meta",{"property":"article:tag","content":"UE5"}],["meta",{"property":"article:published_time","content":"2023-12-20T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-11-03T04:57:26.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"UE5+Perforce+腾讯云版本控制搭建流程与工作流程\\",\\"image\\":[\\"https://megestus-1309556466.cos.ap-shanghai.myqcloud.com/img/p4nas.png\\"],\\"datePublished\\":\\"2023-12-20T00:00:00.000Z\\",\\"dateModified\\":\\"2024-11-03T04:57:26.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Megestus\\",\\"url\\":\\"https://github.com/Megestus\\"}]}"]]},"headers":[{"level":2,"title":"购买服务器","slug":"购买服务器","link":"#购买服务器","children":[]},{"level":2,"title":"开始部署","slug":"开始部署","link":"#开始部署","children":[]},{"level":2,"title":"部署Perforce","slug":"部署perforce","link":"#部署perforce","children":[{"level":3,"title":"一键部署","slug":"一键部署","link":"#一键部署","children":[]},{"level":3,"title":"支持Unicode的镜像","slug":"支持unicode的镜像","link":"#支持unicode的镜像","children":[]},{"level":3,"title":"开放防火墙端口","slug":"开放防火墙端口","link":"#开放防火墙端口","children":[]}]},{"level":2,"title":"安装P4V客户端","slug":"安装p4v客户端","link":"#安装p4v客户端","children":[{"level":3,"title":"P4V安装过程","slug":"p4v安装过程","link":"#p4v安装过程","children":[]}]},{"level":2,"title":"使用说明","slug":"使用说明","link":"#使用说明","children":[]},{"level":2,"title":"P4 Typemap 和 P4ignore","slug":"p4-typemap-和-p4ignore","link":"#p4-typemap-和-p4ignore","children":[{"level":3,"title":"P4 Typemap","slug":"p4-typemap","link":"#p4-typemap","children":[]},{"level":3,"title":"P4ignore","slug":"p4ignore","link":"#p4ignore","children":[]}]},{"level":2,"title":"UE5源码连接","slug":"ue5源码连接","link":"#ue5源码连接","children":[]}],"git":{"createdTime":1711204216000,"updatedTime":1730609846000,"contributors":[{"name":"Megestus","email":"75190962+Megestus@users.noreply.github.com","commits":7},{"name":"Megestus","email":"2624203622@qq.com","commits":4}]},"filePathRelative":"posts/Perforce/PerforceSet.md","localizedDate":"2023年12月20日","excerpt":"<p>本文详细记录了在云服务器上部署Perforce的完整流程。之前在知乎上介绍过使用NAS部署P4,以及Perforce的工作原理和作用。这次我们将探讨如何在没有NAS的情况下,快速为团队创建一个Perforce服务。</p>\\n<p><i class=\\"fa-solid fa-cable-car\\"></i> 相关文章：<a href=\\"https://www.zhihu.com/tardis/zm/art/606970716?source_id=1005\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">从零开始在NAS上配置Perforce并启用虚幻引擎源码管理</a></p>\\n","autoDesc":true}');export{b as comp,f as data};
