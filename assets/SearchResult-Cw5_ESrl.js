import{u as z,g as Z,h as ee,i as N,j as te,k as ae,t as se,l as re,m as B,n as q,p as le,q as U,s as a,v as O,x as _,R as $,y as ue,z as oe,A as ne,B as ie,C as ce,D as he,E as ve,F as pe,O as me,G as de,H as ye,P as ge,I as fe,J as ke,K as M}from"./app-nsltsgkw.js";const xe=["/Friends.html","/","/intro.html","/log.html","/demo/","/engine/","/posts/","/server/","/demo/vuepress/mdNotes.html","/demo/vuepress/page.html","/demo/vuepress/vuepressdebug.html","/engine/unity/shader0.html","/engine/unity/shader1.html","/engine/unity/shader10.html","/engine/unity/shader11.html","/engine/unity/shader2.html","/engine/unity/shader3.html","/engine/unity/shader4.html","/engine/unity/shader5.html","/engine/unity/shader6.html","/engine/unity/shader7.html","/engine/unity/shader8.html","/engine/unity/shader9.html","/engine/unreal/test.html","/posts/3dmax/MaxNotes.html","/posts/3dmax/Maxscript101.html","/posts/3dmax/MaxscriptLearn.html","/posts/Perforce/P4checTips.html","/posts/Perforce/P4ignore.html","/posts/Perforce/PerforceCmd.html","/posts/Perforce/PerforceSet.html","/posts/Substance/SPAOBake.html","/posts/maya/MayaChecklist.html","/posts/maya/MayaNotes.html","/posts/maya/PythonLearn.html","/posts/maya/Pythonwindow.html","/posts/maya/UVset.html","/posts/maya/melLearn.html","/posts/maya/selectEdges.html","/posts/zbrush/pathset.html","/server/app/GitHubActions.html","/server/app/gallery.html","/server/app/lankong.html","/server/app/windowstips.html","/server/docker/NPS_NPM.html","/server/docker/Portainer.html","/server/docker/docker.html","/server/docker/linux.html","/server/docker/mariadb.html","/404.html","/demo/vuepress/","/engine/unity/","/engine/unreal/","/posts/3dmax/","/posts/Perforce/","/posts/Substance/","/posts/maya/","/posts/zbrush/","/server/app/","/server/docker/","/category/","/category/shader/","/category/3dmax/","/category/perforce/","/category/substance/","/category/maya/","/category/zbrush/","/category/github/","/category/%E5%9B%BE%E5%BA%8A/","/category/windows/","/category/docker/","/category/linux/","/tag/","/tag/shader/","/tag/unity/","/tag/3dmax/","/tag/tips/","/tag/perforce/","/tag/ignore/","/tag/cloud-sever/","/tag/teams/","/tag/ue5/","/tag/substance-paint/","/tag/substance/","/tag/maya/","/tag/tool/","/tag/checklist/","/tag/python/","/tag/mel/","/tag/zbrush/","/tag/github/","/tag/automation/","/tag/actions/","/tag/%E5%9B%BE%E5%BA%8A/","/tag/gallery/","/tag/lsky/","/tag/windows/","/tag/docker/","/tag/nas/","/tag/portainer/","/tag/linux/","/tag/mariadb/","/tag/adminer/","/tag/mysql/","/article/","/star/","/timeline/"],He="SEARCH_PRO_QUERY_HISTORY",m=z(He,[]),be=()=>{const{queryHistoryCount:s}=M,r=s>0;return{enabled:r,queryHistory:m,addQueryHistory:l=>{r&&(m.value.length<s?m.value=Array.from(new Set([l,...m.value])):m.value=Array.from(new Set([l,...m.value.slice(0,s-1)])))},removeQueryHistory:l=>{m.value=[...m.value.slice(0,l),...m.value.slice(l+1)]}}},D=s=>xe[s.id]+("anchor"in s?`#${s.anchor}`:""),we="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:L}=M,d=z(we,[]),Re=()=>{const s=L>0;return{enabled:s,resultHistory:d,addResultHistory:r=>{if(s){const l={link:D(r),display:r.display};"header"in r&&(l.header=r.header),d.value.length<L?d.value=[l,...d.value]:d.value=[l,...d.value.slice(0,L-1)]}},removeResultHistory:r=>{d.value=[...d.value.slice(0,r),...d.value.slice(r+1)]}}},Pe=s=>{const r=ce(),l=N(),S=he(),o=B(!1),g=ve([]);return pe(()=>{const{search:H,terminate:y}=me(),b=()=>{g.value=[],o.value=!1},f=ke(v=>{o.value=!0,v?H(v,l.value,r.value).then(p=>{var w,k;return((k=(w=r.value).searchFilter)==null?void 0:k.call(w,p,v,l.value,S.value))??p}).then(p=>{g.value=p,o.value=!1}).catch(p=>{console.error(p),b()}):b()},M.searchDelay);U([s,l],()=>f(s.value),{immediate:!0}),de(()=>{y()})}),{searching:o,results:g}};var Qe=Z({name:"SearchResult",props:{query:{type:String,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:r}){const l=ee(),S=N(),o=te(ae),{enabled:g,addQueryHistory:H,queryHistory:y,removeQueryHistory:b}=be(),{enabled:f,resultHistory:v,addResultHistory:p,removeResultHistory:w}=Re(),k=g||f,Q=se(s,"query"),{results:x,searching:I}=Pe(Q),u=re({isQuery:!0,index:0}),c=B(0),h=B(0),T=q(()=>k&&(y.value.length>0||v.value.length>0)),C=q(()=>x.value.length>0),A=q(()=>x.value[c.value]||null),j=()=>{const{isQuery:e,index:t}=u;t===0?(u.isQuery=!e,u.index=e?v.value.length-1:y.value.length-1):u.index=t-1},G=()=>{const{isQuery:e,index:t}=u;t===(e?y.value.length-1:v.value.length-1)?(u.isQuery=!e,u.index=0):u.index=t+1},V=()=>{c.value=c.value>0?c.value-1:x.value.length-1,h.value=A.value.contents.length-1},Y=()=>{c.value=c.value<x.value.length-1?c.value+1:0,h.value=0},J=()=>{h.value<A.value.contents.length-1?h.value+=1:Y()},K=()=>{h.value>0?h.value-=1:V()},E=e=>e.map(t=>ye(t)?t:a(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=ge[e.index]||"$content",[n,P=""]=fe(t)?t[S.value].split("$content"):t.split("$content");return e.display.map(i=>a("div",E([n,...i,P])))}return e.display.map(t=>a("div",E(t)))},R=()=>{c.value=0,h.value=0,r("updateQuery",""),r("close")};return le("keydown",e=>{if(s.isFocusing){if(C.value){if(e.key==="ArrowUp")K();else if(e.key==="ArrowDown")J();else if(e.key==="Enter"){const t=A.value.contents[h.value];H(s.query),p(t),l.push(D(t)),R()}}else if(f){if(e.key==="ArrowUp")j();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:t}=u;u.isQuery?(r("updateQuery",y.value[t]),e.preventDefault()):(l.push(v.value[t].link),R())}}}}),U([c,h],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>a("div",{class:["search-pro-result-wrapper",{empty:Q.value?!C.value:!T.value}],id:"search-pro-results"},Q.value===""?k?T.value?[g?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},o.value.queryHistory),y.value.map((e,t)=>a("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===t}],onClick:()=>{r("updateQuery",e)}},[a(O,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},e),a("button",{class:"search-pro-remove-icon",innerHTML:_,onClick:n=>{n.preventDefault(),n.stopPropagation(),b(t)}})]))])):null,f?a("ul",{class:"search-pro-result-list"},a("li",{class:"search-pro-result-list-item"},[a("div",{class:"search-pro-result-title"},o.value.resultHistory),v.value.map((e,t)=>a($,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===t}],onClick:()=>{R()}},()=>[a(O,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[e.header?a("div",{class:"content-header"},e.header):null,a("div",e.display.map(n=>E(n)).flat())]),a("button",{class:"search-pro-remove-icon",innerHTML:_,onClick:n=>{n.preventDefault(),n.stopPropagation(),w(t)}})]))])):null]:o.value.emptyHistory:o.value.emptyResult:I.value?a(ue,{hint:o.value.searching}):C.value?a("ul",{class:"search-pro-result-list"},x.value.map(({title:e,contents:t},n)=>{const P=c.value===n;return a("li",{class:["search-pro-result-list-item",{active:P}]},[a("div",{class:"search-pro-result-title"},e||o.value.defaultTitle),t.map((i,X)=>{const F=P&&h.value===X;return a($,{to:D(i),class:["search-pro-result-item",{active:F,"aria-selected":F}],onClick:()=>{H(s.query),p(i),R()}},()=>[i.type==="text"?null:a(i.type==="title"?oe:i.type==="heading"?ne:ie,{class:"search-pro-result-type"}),a("div",{class:"search-pro-result-content"},[i.type==="text"&&i.header?a("div",{class:"content-header"},i.header):null,a("div",W(i))])])})])})):o.value.emptyResult)}});export{Qe as default};
